# RunPod Serverless Setup

## 1. Create GitHub Repository

```bash
# Already done locally, now push to GitHub
git remote add origin https://github.com/YOUR_USERNAME/spacex-chess-eval.git
git push -u origin master
```

Make repo public or give RunPod access.

## 2. Create RunPod Serverless Endpoint

Go to: https://www.runpod.io/console/serverless

Click "New Endpoint"

### Configuration:

**Template:**
- Name: SpaceX Chess Eval
- Container Image: Leave EMPTY (will use GitHub)
- Docker Command: python -u handler.py

**GitHub Integration:**
- Connect GitHub repo: YOUR_USERNAME/spacex-chess-eval
- Branch: master
- Build automatically on push

**GPU Selection:**
- Select: RTX A4000 or better
- Min: 16GB VRAM

**Container Settings:**
- Container Disk: 20 GB
- Volume Size: 50 GB (IMPORTANT - for dataset caching)

**Environment Variables:**
Add these secrets:
```
R2_ENDPOINT_URL=https://52df42bc9560097648dbd0cd885e08d5.r2.cloudflarestorage.com
R2_ACCESS_KEY_ID=a62246b01ea4f7082d92eb6ccfd41b40
R2_SECRET_ACCESS_KEY=f9c66ab00cbf08adbe30a14a97fb47a4219b02c5b485fce18f73696875bb039b
R2_BUCKET_NAME=chess
```

**Advanced Settings:**
- Workers: Min 0, Max 3
- Idle Timeout: 30 seconds
- Execution Timeout: 900 seconds (15 min)
- Max Concurrent Requests: 1

## 3. Get API Credentials

After creating endpoint:
- Copy **Endpoint ID** (looks like: abc123def456)
- Go to Settings → API Keys → Create API Key
- Copy **API Key**

## 4. Add to Railway Environment Variables

```
RUNPOD_API_KEY=your_api_key_here
RUNPOD_ENDPOINT_ID=your_endpoint_id_here
```

## How It Works

1. RunPod pulls code from GitHub
2. Builds Docker image on their infrastructure (fast!)
3. First job: Downloads 665MB test dataset from R2 to volume
4. Subsequent jobs: Uses cached dataset (instant)
5. Results uploaded back to R2

## Testing

After setup, submit a demo through Railway. Check:
- Railway logs: "RunPod job created: xxx"
- RunPod dashboard: See job in queue
- RunPod logs: Watch evaluation progress
- Railway: Results appear when complete

## Benefits vs Docker Hub

✅ No 5GB upload needed
✅ Builds on RunPod's fast infrastructure
✅ Auto-rebuilds on git push
✅ Volume caching works same as Docker Hub approach
